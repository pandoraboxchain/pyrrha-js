/**
 * Ensuring expected parameters helper
 * This file it is a part of the Pandora Pyrrha Javascript library
 * 
 * @file expect.js
 * @author Kostiantyn Smyrnov <kostysh@gmail.com>
 * @date 2018
 */
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.all = void 0;

var _errors = _interopRequireWildcard(require("./errors"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

const all = (options = {}, model = {}) => {
  if (typeof options !== 'object' || Object.keys(options).length === 0) {
    throw (0, _errors.default)(_errors.OPTIONS_REQUIRED);
  }

  for (let key of Object.keys(model)) {
    let value = key.split('.').reduce((acc, part) => {
      return acc[part] !== undefined ? acc[part] : null;
    }, options);
    let memberValue;

    switch (model[key].type) {
      case 'enum':
        if (!model[key].values || !Array.isArray(model[key].values)) {
          throw _errors.default.apply(undefined, [model[key].code || _errors.EXPECT_TYPE_OPTIONS_REQUIRED, key, model[key].type, value, ...(model[key].args ? model[key].args : [undefined])]);
        }

        if (!model[key].values.includes(value)) {
          throw _errors.default.apply(undefined, [model[key].code || _errors.WRONG_TYPE, key, model[key].type, value, ...(model[key].args ? model[key].args : [undefined])]);
        }

        break;

      case 'address':
        if (!new RegExp('^0x[a-fA-F0-9]{40}$').test(value)) {
          throw _errors.default.apply(undefined, [model[key].code || _errors.ADDRESS_REQUIRED, key, model[key].type, value, ...(model[key].args ? model[key].args : [undefined])]);
        }

        break;

      case 'member':
        if (!model[key].provider || typeof model[key].provider !== 'object') {
          throw _errors.default.apply(undefined, [model[key].code || `Provider object must be defined as "provider" model option for "${key}"`, key, model[key].type, value, ...(model[key].args ? model[key].args : [undefined])]);
        }

        memberValue = value.split('.').reduce((acc, part) => {
          return acc && acc[part] !== undefined ? acc[part] : null;
        }, model[key].provider);

        if (!memberValue) {
          throw _errors.default.apply(undefined, [model[key].code || _errors.EXPECT_NOT_A_MEMBER, key, model[key].type, value, ...(model[key].args ? model[key].args : [undefined])]);
        }

        break;

      default:
        if (typeof value !== model[key].type && (model[key].required === true || model[key].required === undefined)) {
          throw _errors.default.apply(undefined, [model[key].code || _errors.WRONG_TYPE, key, model[key].type, value, ...(model[key].args ? model[key].args : [undefined])]);
        }

    }
  }
};

exports.all = all;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL2V4cGVjdC5qcyJdLCJuYW1lcyI6WyJhbGwiLCJvcHRpb25zIiwibW9kZWwiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiT1BUSU9OU19SRVFVSVJFRCIsImtleSIsInZhbHVlIiwic3BsaXQiLCJyZWR1Y2UiLCJhY2MiLCJwYXJ0IiwidW5kZWZpbmVkIiwibWVtYmVyVmFsdWUiLCJ0eXBlIiwidmFsdWVzIiwiQXJyYXkiLCJpc0FycmF5IiwiUGpzRXJyb3IiLCJhcHBseSIsImNvZGUiLCJFWFBFQ1RfVFlQRV9PUFRJT05TX1JFUVVJUkVEIiwiYXJncyIsImluY2x1ZGVzIiwiV1JPTkdfVFlQRSIsIlJlZ0V4cCIsInRlc3QiLCJBRERSRVNTX1JFUVVJUkVEIiwicHJvdmlkZXIiLCJFWFBFQ1RfTk9UX0FfTUVNQkVSIiwicmVxdWlyZWQiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7OztBQVNBOzs7Ozs7O0FBRUE7Ozs7QUFRTyxNQUFNQSxNQUFNLENBQUNDLFVBQVUsRUFBWCxFQUFlQyxRQUFRLEVBQXZCLEtBQThCO0FBRTdDLE1BQUksT0FBT0QsT0FBUCxLQUFtQixRQUFuQixJQUErQkUsT0FBT0MsSUFBUCxDQUFZSCxPQUFaLEVBQXFCSSxNQUFyQixLQUFnQyxDQUFuRSxFQUFzRTtBQUVsRSxVQUFNLHFCQUFTQyx3QkFBVCxDQUFOO0FBQ0g7O0FBRUQsT0FBSyxJQUFJQyxHQUFULElBQWdCSixPQUFPQyxJQUFQLENBQVlGLEtBQVosQ0FBaEIsRUFBb0M7QUFFaEMsUUFBSU0sUUFBUUQsSUFBSUUsS0FBSixDQUFVLEdBQVYsRUFBZUMsTUFBZixDQUFzQixDQUFDQyxHQUFELEVBQU1DLElBQU4sS0FBZTtBQUM3QyxhQUFPRCxJQUFJQyxJQUFKLE1BQWNDLFNBQWQsR0FBMEJGLElBQUlDLElBQUosQ0FBMUIsR0FBc0MsSUFBN0M7QUFDSCxLQUZXLEVBRVRYLE9BRlMsQ0FBWjtBQUlBLFFBQUlhLFdBQUo7O0FBRUEsWUFBUVos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QUFXUSxJQUhpQixFQUk1QlAsS0FKNEIsRUFLNUIsSUFBSU4sTUFBTUssR0FBTixFQUFXZ0IsSUFBWCxHQUFrQnJCLE1BQU1LLEdBQU4sRUFBV2dCLElBQTdCLEdBQW9DLENBQUNWLFNBQUQsQ0FBeEMsQ0FMNEIsQ0FBMUIsQ0FBTjtBQU9IOztBQUVEOztBQUVKO0FBRUksWUFBSSxPQUFPTCxLQUFQLEtBQWlCTixNQUFNSyxHQUFOLEVBQVdRLElBQTVCLEtBQ0NiLE1BQU1LLEdBQU4sRUFBV3dCLFFBQVgsS0FBd0IsSUFBeEIsSUFBZ0M3QixNQUFNSyxHQUFOLEVBQVd3QixRQUFYLEtBQXdCbEIsU0FEekQsQ0FBSixFQUN5RTtBQUVyRSxnQkFBTU0sZ0JBQVNDLEtBQVQsQ0FBZVAsU0FBZixFQUEwQixDQUM1QlgsTUFBTUssR0FBTixFQUFXYyxJQUFYLElBQW1CSSxrQkFEUyxFQUU1QmxCLEdBRjRCLEVBRzVCTCxNQUFNSyxHQUFOLEVBQVdRLElBSGlCLEVBSTVCUCxLQUo0QixFQUs1QixJQUFJTixNQUFNSyxHQUFOLEVBQVdnQixJQUFYLEdBQWtCckIsTUFBTUssR0FBTixFQUFXZ0IsSUFBN0IsR0FBb0MsQ0FBQ1YsU0FBRCxDQUF4QyxDQUw0QixDQUExQixDQUFOO0FBT0g7O0FBcEZUO0FBc0ZIO0FBQ0osQ0F0R00iLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVuc3VyaW5nIGV4cGVjdGVkIHBhcmFtZXRlcnMgaGVscGVyXG4gKiBUaGlzIGZpbGUgaXQgaXMgYSBwYXJ0IG9mIHRoZSBQYW5kb3JhIFB5cnJoYSBKYXZhc2NyaXB0IGxpYnJhcnlcbiAqIFxuICogQGZpbGUgZXhwZWN0LmpzXG4gKiBAYXV0aG9yIEtvc3RpYW50eW4gU215cm5vdiA8a29zdHlzaEBnbWFpbC5jb20+XG4gKiBAZGF0ZSAyMDE4XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgUGpzRXJyb3IsIHtcbiAgICBPUFRJT05TX1JFUVVJUkVELFxuICAgIFdST05HX1RZUEUsXG4gICAgQUREUkVTU19SRVFVSVJFRCxcbiAgICBFWFBFQ1RfTk9UX0FfTUVNQkVSLFxuICAgIEVYUEVDVF9UWVBFX09QVElPTlNfUkVRVUlSRURcbn0gZnJvbSAnLi9lcnJvcnMnO1xuXG5leHBvcnQgY29uc3QgYWxsID0gKG9wdGlvbnMgPSB7fSwgbW9kZWwgPSB7fSkgPT4ge1xuXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0JyB8fCBPYmplY3Qua2V5cyhvcHRpb25zKS5sZW5ndGggPT09IDApIHtcblxuICAgICAgICB0aHJvdyBQanNFcnJvcihPUFRJT05TX1JFUVVJUkVEKTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBrZXkgb2YgT2JqZWN0LmtleXMobW9kZWwpKSB7XG5cbiAgICAgICAgbGV0IHZhbHVlID0ga2V5LnNwbGl0KCcuJykucmVkdWNlKChhY2MsIHBhcnQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhY2NbcGFydF0gIT09IHVuZGVmaW5lZCA/IGFjY1twYXJ0XSA6IG51bGw7XG4gICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgIGxldCBtZW1iZXJWYWx1ZTtcblxuICAgICAgICBzd2l0Y2ggKG1vZGVsW2tleV0udHlwZSkge1xuICAgICAgICAgICAgY2FzZSAnZW51bSc6XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1vZGVsW2tleV0udmFsdWVzIHx8ICFBcnJheS5pc0FycmF5KG1vZGVsW2tleV0udmFsdWVzKSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRocm93IFBqc0Vycm9yLmFwcGx5KHVuZGVmaW5lZCwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxba2V5XS5jb2RlIHx8IEVYUEVDVF9UWVBFX09QVElPTlNfUkVRVUlSRUQsIFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5LCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsW2tleV0udHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgLi4uKG1vZGVsW2tleV0uYXJncyA/IG1vZGVsW2tleV0uYXJncyA6IFt1bmRlZmluZWRdKVxuICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1vZGVsW2tleV0udmFsdWVzLmluY2x1ZGVzKHZhbHVlKSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRocm93IFBqc0Vycm9yLmFwcGx5KHVuZGVmaW5lZCwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxba2V5XS5jb2RlIHx8IFdST05HX1RZUEUsIFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5LCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsW2tleV0udHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgLi4uKG1vZGVsW2tleV0uYXJncyA/IG1vZGVsW2tleV0uYXJncyA6IFt1bmRlZmluZWRdKVxuICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnYWRkcmVzcyc6XG5cbiAgICAgICAgICAgICAgICBpZiAoIW5ldyBSZWdFeHAoJ14weFthLWZBLUYwLTldezQwfSQnKS50ZXN0KHZhbHVlKSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRocm93IFBqc0Vycm9yLmFwcGx5KHVuZGVmaW5lZCwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxba2V5XS5jb2RlIHx8IEFERFJFU1NfUkVRVUlSRUQsIFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5LCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsW2tleV0udHlwZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLihtb2RlbFtrZXldLmFyZ3MgPyBtb2RlbFtrZXldLmFyZ3MgOiBbdW5kZWZpbmVkXSlcbiAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ21lbWJlcic6XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKCFtb2RlbFtrZXldLnByb3ZpZGVyIHx8IHR5cGVvZiBtb2RlbFtrZXldLnByb3ZpZGVyICE9PSAnb2JqZWN0Jykge1xuXG4gICAgICAgICAgICAgICAgICAgIHRocm93IFBqc0Vycm9yLmFwcGx5KHVuZGVmaW5lZCwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxba2V5XS5jb2RlIHx8IGBQcm92aWRlciBvYmplY3QgbXVzdCBiZSBkZWZpbmVkIGFzIFwicHJvdmlkZXJcIiBtb2RlbCBvcHRpb24gZm9yIFwiJHtrZXl9XCJgLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbFtrZXldLnR5cGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4obW9kZWxba2V5XS5hcmdzID8gbW9kZWxba2V5XS5hcmdzIDogW3VuZGVmaW5lZF0pXG4gICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1lbWJlclZhbHVlID0gdmFsdWUuc3BsaXQoJy4nKS5yZWR1Y2UoKGFjYywgcGFydCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWNjICYmIGFjY1twYXJ0XSAhPT0gdW5kZWZpbmVkID8gYWNjW3BhcnRdIDogbnVsbDtcbiAgICAgICAgICAgICAgICB9LCBtb2RlbFtrZXldLnByb3ZpZGVyKTtcblxuICAgICAgICAgICAgICAgIGlmICghbWVtYmVyVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBQanNFcnJvci5hcHBseSh1bmRlZmluZWQsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsW2tleV0uY29kZSB8fCBFWFBFQ1RfTk9UX0FfTUVNQkVSLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSwgXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbFtrZXldLnR5cGUsIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4obW9kZWxba2V5XS5hcmdzID8gbW9kZWxba2V5XS5hcmdzIDogW3VuZGVmaW5lZF0pXG4gICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09IG1vZGVsW2tleV0udHlwZSAmJiBcbiAgICAgICAgICAgICAgICAgICAgKG1vZGVsW2tleV0ucmVxdWlyZWQgPT09IHRydWUgfHwgbW9kZWxba2V5XS5yZXF1aXJlZCA9PT0gdW5kZWZpbmVkKSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRocm93IFBqc0Vycm9yLmFwcGx5KHVuZGVmaW5lZCwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxba2V5XS5jb2RlIHx8IFdST05HX1RZUEUsIFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5LCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsW2tleV0udHlwZSwgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLihtb2RlbFtrZXldLmFyZ3MgPyBtb2RlbFtrZXldLmFyZ3MgOiBbdW5kZWZpbmVkXSlcbiAgICAgICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9ICAgICAgICBcbiAgICB9XG59O1xuIl19